<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>BASS4 ui demo</title>
    <link href="/assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="/assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="main"></div>
<script src="/js/jquery/jquery-3.2.0.min.js" type="text/javascript"></script>
<script src="/assets/bootstrap/js/bootstrap.bundle.min.js" type="text/javascript"></script>
<script type="text/javascript">
   $(document).ready(function () {
      $.ajax("/user/api/tx/messages", {
         success: function (data) {
            var $message_div = $('#main');
            var messages = $.map(data, function (m) {
               var message = m['text'].replace(/(?:\r\n|\r|\n)/g, '<br>');
               var sender = (m['sender-type'] === 'therapist') ? m['sender-name'] : 'me';
               var time = new Date(m['send-datetime']).toDateString();
               $message_div.append('<p>From: ' + sender + '</p>');
               $message_div.append('<p>' + time + '</p>');
               $message_div.append('<p><em>' + message + '</em></p>');
            });
         }
      });
   });
</script>
</body>
</html>
